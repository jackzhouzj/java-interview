# Javaè®¾è®¡æ¨¡å¼ å®Œæ•´æ•™ç¨‹

## ğŸ“‹ ç›®å½•
- [æŠ€æœ¯æ¦‚è¿°](#æŠ€æœ¯æ¦‚è¿°)
- [å­¦ä¹ ç›®æ ‡](#å­¦ä¹ ç›®æ ‡)
- [è®¾è®¡åŸåˆ™](#è®¾è®¡åŸåˆ™)
- [åˆ›å»ºå‹æ¨¡å¼](#åˆ›å»ºå‹æ¨¡å¼)
- [ç»“æ„å‹æ¨¡å¼](#ç»“æ„å‹æ¨¡å¼)
- [è¡Œä¸ºå‹æ¨¡å¼](#è¡Œä¸ºå‹æ¨¡å¼)
- [å®æˆ˜åº”ç”¨](#å®æˆ˜åº”ç”¨)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [ç›¸å…³èµ„æº](#ç›¸å…³èµ„æº)
- [å­¦ä¹ æ£€æŸ¥æ¸…å•](#å­¦ä¹ æ£€æŸ¥æ¸…å•)

## ğŸ“š æŠ€æœ¯æ¦‚è¿°
- **ç‰ˆæœ¬**: é€šç”¨
- **å‚è€ƒä¹¦ç±**: ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ï¼ˆGoFï¼‰
- **å­¦ä¹ éš¾åº¦**: â­â­â­â­ (4æ˜Ÿ)
- **é‡è¦ç¨‹åº¦**: â­â­â­â­â­ (5æ˜Ÿ)
- **å‰ç½®çŸ¥è¯†**: JavaåŸºç¡€ã€é¢å‘å¯¹è±¡ç¼–ç¨‹
- **æ–‡æ¡£æ¥æº**: GoFè®¾è®¡æ¨¡å¼ + ã€ŠHead Firstè®¾è®¡æ¨¡å¼ã€‹
- **æ›´æ–°æ—¶é—´**: 2024-01-04
- **ä½œè€…**: @author erik.zhou

## ğŸ¯ å­¦ä¹ ç›®æ ‡
- [ ] ç†è§£23ç§è®¾è®¡æ¨¡å¼çš„å®šä¹‰å’Œåº”ç”¨åœºæ™¯
- [ ] æŒæ¡å…­å¤§è®¾è®¡åŸåˆ™ï¼ˆSOLID + è¿ªç±³ç‰¹æ³•åˆ™ + å¼€é—­åŸåˆ™ï¼‰
- [ ] èƒ½å¤Ÿè¯†åˆ«ä»£ç ä¸­çš„è®¾è®¡æ¨¡å¼
- [ ] èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨åˆé€‚çš„è®¾è®¡æ¨¡å¼
- [ ] ç†è§£è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»å’ŒåŒºåˆ«
- [ ] é¿å…è¿‡åº¦è®¾è®¡å’Œæ¨¡å¼æ»¥ç”¨

## ğŸ“– è®¾è®¡åŸåˆ™

### å…­å¤§è®¾è®¡åŸåˆ™ ğŸ”¥

#### 1. å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰
**å®šä¹‰**: ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› 

```java
/**
 * å•ä¸€èŒè´£åŸåˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šä¸€ä¸ªç±»æ‰¿æ‹…å¤šä¸ªèŒè´£
class User {
    private String name;
    private String email;
    
    public void save() {
        // ä¿å­˜åˆ°æ•°æ®åº“
    }
    
    public void sendEmail() {
        // å‘é€é‚®ä»¶
    }
}

// æ­£ç¡®ï¼šèŒè´£åˆ†ç¦»
class User {
    private String name;
    private String email;
    // getter/setter
}

class UserRepository {
    public void save(User user) {
        // ä¿å­˜åˆ°æ•°æ®åº“
    }
}

class EmailService {
    public void sendEmail(String email, String content) {
        // å‘é€é‚®ä»¶
    }
}
```

#### 2. å¼€é—­åŸåˆ™ï¼ˆOCPï¼‰ğŸ”¥
**å®šä¹‰**: å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­

```java
/**
 * å¼€é—­åŸåˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šæ¯æ¬¡æ–°å¢ç±»å‹éƒ½è¦ä¿®æ”¹ä»£ç 
class PaymentService {
    public void pay(String type, double amount) {
        if ("alipay".equals(type)) {
            // æ”¯ä»˜å®æ”¯ä»˜
        } else if ("wechat".equals(type)) {
            // å¾®ä¿¡æ”¯ä»˜
        }
    }
}

// æ­£ç¡®ï¼šé€šè¿‡æ¥å£æ‰©å±•
interface Payment {
    void pay(double amount);
}

class AlipayPayment implements Payment {
    @Override
    public void pay(double amount) {
        System.out.println("æ”¯ä»˜å®æ”¯ä»˜ï¼š" + amount);
    }
}

class WechatPayment implements Payment {
    @Override
    public void pay(double amount) {
        System.out.println("å¾®ä¿¡æ”¯ä»˜ï¼š" + amount);
    }
}
```


#### 3. é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼‰
**å®šä¹‰**: å­ç±»å¯ä»¥æ›¿æ¢çˆ¶ç±»ï¼Œä¸”ç¨‹åºè¡Œä¸ºä¸å˜

```java
/**
 * é‡Œæ°æ›¿æ¢åŸåˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šå­ç±»æ”¹å˜äº†çˆ¶ç±»çš„è¡Œä¸º
class Rectangle {
    protected int width;
    protected int height;
    
    public void setWidth(int width) {
        this.width = width;
    }
    
    public void setHeight(int height) {
        this.height = height;
    }
    
    public int getArea() {
        return width * height;
    }
}

class Square extends Rectangle {
    @Override
    public void setWidth(int width) {
        this.width = width;
        this.height = width; // è¿åLSP
    }
    
    @Override
    public void setHeight(int height) {
        this.width = height;
        this.height = height; // è¿åLSP
    }
}

// æ­£ç¡®ï¼šä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿
interface Shape {
    int getArea();
}

class Rectangle implements Shape {
    private int width;
    private int height;
    
    @Override
    public int getArea() {
        return width * height;
    }
}

class Square implements Shape {
    private int side;
    
    @Override
    public int getArea() {
        return side * side;
    }
}
```

#### 4. æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰
**å®šä¹‰**: å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£

```java
/**
 * æ¥å£éš”ç¦»åŸåˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šæ¥å£è¿‡äºè‡ƒè‚¿
interface Worker {
    void work();
    void eat();
    void sleep();
}

// æ­£ç¡®ï¼šæ¥å£ç»†åŒ–
interface Workable {
    void work();
}

interface Eatable {
    void eat();
}

interface Sleepable {
    void sleep();
}

class Human implements Workable, Eatable, Sleepable {
    @Override
    public void work() {
        System.out.println("äººç±»å·¥ä½œ");
    }
    
    @Override
    public void eat() {
        System.out.println("äººç±»åƒé¥­");
    }
    
    @Override
    public void sleep() {
        System.out.println("äººç±»ç¡è§‰");
    }
}

class Robot implements Workable {
    @Override
    public void work() {
        System.out.println("æœºå™¨äººå·¥ä½œ");
    }
}
```

#### 5. ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰ğŸ”¥
**å®šä¹‰**: é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–æŠ½è±¡

```java
/**
 * ä¾èµ–å€’ç½®åŸåˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šé«˜å±‚ä¾èµ–ä½å±‚
class UserService {
    private MySQLDatabase database = new MySQLDatabase();
    
    public void saveUser(User user) {
        database.save(user);
    }
}

// æ­£ç¡®ï¼šä¾èµ–æŠ½è±¡
interface Database {
    void save(Object obj);
}

class MySQLDatabase implements Database {
    @Override
    public void save(Object obj) {
        System.out.println("ä¿å­˜åˆ°MySQL");
    }
}

class MongoDatabase implements Database {
    @Override
    public void save(Object obj) {
        System.out.println("ä¿å­˜åˆ°MongoDB");
    }
}

class UserService {
    private final Database database;
    
    // ä¾èµ–æ³¨å…¥
    public UserService(Database database) {
        this.database = database;
    }
    
    public void saveUser(User user) {
        database.save(user);
    }
}
```

#### 6. è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLoDï¼‰
**å®šä¹‰**: ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£

```java
/**
 * è¿ªç±³ç‰¹æ³•åˆ™ç¤ºä¾‹
 * @author erik.zhou
 */
// é”™è¯¯ï¼šè¿‡å¤šäº†è§£å…¶ä»–å¯¹è±¡
class Customer {
    public void buyProduct(Shop shop) {
        Wallet wallet = shop.getOwner().getWallet();
        if (wallet.getMoney() > 100) {
            // è´­ä¹°é€»è¾‘
        }
    }
}

// æ­£ç¡®ï¼šåªä¸ç›´æ¥æœ‹å‹é€šä¿¡
class Customer {
    public void buyProduct(Shop shop) {
        if (shop.canSell()) {
            // è´­ä¹°é€»è¾‘
        }
    }
}

class Shop {
    private Owner owner;
    
    public boolean canSell() {
        return owner.hasEnoughMoney(100);
    }
}
```

## ğŸ”¥ åˆ›å»ºå‹æ¨¡å¼

åˆ›å»ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ã€‚

### 1. å•ä¾‹æ¨¡å¼ï¼ˆSingletonï¼‰ğŸ”¥

**å®šä¹‰**: ç¡®ä¿ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ç‚¹

**åº”ç”¨åœºæ™¯**: 
- é…ç½®ç®¡ç†å™¨
- æ•°æ®åº“è¿æ¥æ± 
- æ—¥å¿—è®°å½•å™¨
- çº¿ç¨‹æ± 

#### é¥¿æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
```java
/**
 * é¥¿æ±‰å¼å•ä¾‹
 * @author erik.zhou
 */
public class Singleton {
    // ç±»åŠ è½½æ—¶å°±åˆ›å»ºå®ä¾‹
    private static final Singleton INSTANCE = new Singleton();
    
    private Singleton() {
    }
    
    public static Singleton getInstance() {
        return INSTANCE;
    }
}
```

#### æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥é”ï¼‰ğŸ”¥
```java
/**
 * æ‡’æ±‰å¼å•ä¾‹ï¼ˆåŒé‡æ£€æŸ¥é”ï¼‰
 * @author erik.zhou
 */
public class Singleton {
    private static volatile Singleton instance;
    
    private Singleton() {
    }
    
    public static Singleton getInstance() {
        if (instance == null) {
            synchronized (Singleton.class) {
                if (instance == null) {
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

#### é™æ€å†…éƒ¨ç±»ï¼ˆæ¨èï¼‰ğŸ”¥
```java
/**
 * é™æ€å†…éƒ¨ç±»å•ä¾‹ï¼ˆæ¨èï¼‰
 * @author erik.zhou
 */
public class Singleton {
    private Singleton() {
    }
    
    private static class SingletonHolder {
        private static final Singleton INSTANCE = new Singleton();
    }
    
    public static Singleton getInstance() {
        return SingletonHolder.INSTANCE;
    }
}
```

#### æšä¸¾å•ä¾‹ï¼ˆæœ€å®‰å…¨ï¼‰
```java
/**
 * æšä¸¾å•ä¾‹ï¼ˆé˜²æ­¢åå°„å’Œåºåˆ—åŒ–ç ´åï¼‰
 * @author erik.zhou
 */
public enum Singleton {
    INSTANCE;
    
    public void doSomething() {
        System.out.println("æ‰§è¡Œä¸šåŠ¡é€»è¾‘");
    }
}
```

### 2. å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory Methodï¼‰ğŸ”¥

**å®šä¹‰**: å®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»

**åº”ç”¨åœºæ™¯**:
- æ—¥å¿—è®°å½•å™¨ï¼ˆæ–‡ä»¶æ—¥å¿—ã€æ•°æ®åº“æ—¥å¿—ï¼‰
- æ•°æ®åº“è¿æ¥ï¼ˆMySQLã€Oracleï¼‰
- æ”¯ä»˜æ–¹å¼ï¼ˆæ”¯ä»˜å®ã€å¾®ä¿¡ï¼‰

```java
/**
 * å·¥å‚æ–¹æ³•æ¨¡å¼
 * @author erik.zhou
 */
// äº§å“æ¥å£
interface Product {
    void use();
}

// å…·ä½“äº§å“
class ConcreteProductA implements Product {
    @Override
    public void use() {
        System.out.println("ä½¿ç”¨äº§å“A");
    }
}

class ConcreteProductB implements Product {
    @Override
    public void use() {
        System.out.println("ä½¿ç”¨äº§å“B");
    }
}

// å·¥å‚æ¥å£
interface Factory {
    Product createProduct();
}

// å…·ä½“å·¥å‚
class FactoryA implements Factory {
    @Override
    public Product createProduct() {
        return new ConcreteProductA();
    }
}

class FactoryB implements Factory {
    @Override
    public Product createProduct() {
        return new ConcreteProductB();
    }
}

// ä½¿ç”¨
public class FactoryMethodDemo {
    public static void main(String[] args) {
        Factory factory = new FactoryA();
        Product product = factory.createProduct();
        product.use();
    }
}
```

### 3. æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰

**å®šä¹‰**: æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£

**åº”ç”¨åœºæ™¯**:
- UIç»„ä»¶åº“ï¼ˆWindowsé£æ ¼ã€Macé£æ ¼ï¼‰
- æ•°æ®åº“è®¿é—®å±‚ï¼ˆMySQLã€Oracleï¼‰

```java
/**
 * æŠ½è±¡å·¥å‚æ¨¡å¼
 * @author erik.zhou
 */
// æŠ½è±¡äº§å“
interface Button {
    void click();
}

interface TextBox {
    void input();
}

// å…·ä½“äº§å“ - Windowsé£æ ¼
class WindowsButton implements Button {
    @Override
    public void click() {
        System.out.println("WindowsæŒ‰é’®ç‚¹å‡»");
    }
}

class WindowsTextBox implements TextBox {
    @Override
    public void input() {
        System.out.println("Windowsæ–‡æœ¬æ¡†è¾“å…¥");
    }
}

// å…·ä½“äº§å“ - Macé£æ ¼
class MacButton implements Button {
    @Override
    public void click() {
        System.out.println("MacæŒ‰é’®ç‚¹å‡»");
    }
}

class MacTextBox implements TextBox {
    @Override
    public void input() {
        System.out.println("Macæ–‡æœ¬æ¡†è¾“å…¥");
    }
}

// æŠ½è±¡å·¥å‚
interface GUIFactory {
    Button createButton();
    TextBox createTextBox();
}

// å…·ä½“å·¥å‚
class WindowsFactory implements GUIFactory {
    @Override
    public Button createButton() {
        return new WindowsButton();
    }
    
    @Override
    public TextBox createTextBox() {
        return new WindowsTextBox();
    }
}

class MacFactory implements GUIFactory {
    @Override
    public Button createButton() {
        return new MacButton();
    }
    
    @Override
    public TextBox createTextBox() {
        return new MacTextBox();
    }
}
```

### 4. å»ºé€ è€…æ¨¡å¼ï¼ˆBuilderï¼‰ğŸ”¥

**å®šä¹‰**: å°†å¤æ‚å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºåˆ†ç¦»

**åº”ç”¨åœºæ™¯**:
- æ„å»ºå¤æ‚å¯¹è±¡ï¼ˆå¦‚HTTPè¯·æ±‚ã€SQLæŸ¥è¯¢ï¼‰
- å¯¹è±¡æœ‰å¤šä¸ªå¯é€‰å‚æ•°

```java
/**
 * å»ºé€ è€…æ¨¡å¼
 * @author erik.zhou
 */
public class User {
    private final String name;          // å¿…å¡«
    private final String email;         // å¿…å¡«
    private final String phone;         // å¯é€‰
    private final String address;       // å¯é€‰
    private final int age;              // å¯é€‰
    
    private User(Builder builder) {
        this.name = builder.name;
        this.email = builder.email;
        this.phone = builder.phone;
        this.address = builder.address;
        this.age = builder.age;
    }
    
    public static class Builder {
        private final String name;
        private final String email;
        private String phone;
        private String address;
        private int age;
        
        public Builder(String name, String email) {
            this.name = name;
            this.email = email;
        }
        
        public Builder phone(String phone) {
            this.phone = phone;
            return this;
        }
        
        public Builder address(String address) {
            this.address = address;
            return this;
        }
        
        public Builder age(int age) {
            this.age = age;
            return this;
        }
        
        public User build() {
            return new User(this);
        }
    }
    
    // ä½¿ç”¨ç¤ºä¾‹
    public static void main(String[] args) {
        User user = new User.Builder("å¼ ä¸‰", "zhangsan@example.com")
                .phone("13800138000")
                .age(25)
                .build();
    }
}
```

### 5. åŸå‹æ¨¡å¼ï¼ˆPrototypeï¼‰

**å®šä¹‰**: é€šè¿‡å¤åˆ¶ç°æœ‰å¯¹è±¡æ¥åˆ›å»ºæ–°å¯¹è±¡

**åº”ç”¨åœºæ™¯**:
- å¯¹è±¡åˆ›å»ºæˆæœ¬é«˜
- éœ€è¦å¤§é‡ç›¸ä¼¼å¯¹è±¡

```java
/**
 * åŸå‹æ¨¡å¼
 * @author erik.zhou
 */
public class Prototype implements Cloneable {
    private String name;
    private List<String> list;
    
    public Prototype(String name) {
        this.name = name;
        this.list = new ArrayList<>();
    }
    
    // æµ…æ‹·è´
    @Override
    public Prototype clone() {
        try {
            return (Prototype) super.clone();
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
    
    // æ·±æ‹·è´
    public Prototype deepClone() {
        try {
            Prototype clone = (Prototype) super.clone();
            clone.list = new ArrayList<>(this.list);
            return clone;
        } catch (CloneNotSupportedException e) {
            throw new RuntimeException(e);
        }
    }
}
```

## ğŸ”¥ ç»“æ„å‹æ¨¡å¼

ç»“æ„å‹æ¨¡å¼å…³æ³¨ç±»å’Œå¯¹è±¡çš„ç»„åˆï¼Œå½¢æˆæ›´å¤§çš„ç»“æ„ã€‚

### 6. ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ğŸ”¥

**å®šä¹‰**: ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®

**åº”ç”¨åœºæ™¯**:
- è¿œç¨‹ä»£ç†ï¼ˆRPCï¼‰
- è™šæ‹Ÿä»£ç†ï¼ˆå»¶è¿ŸåŠ è½½ï¼‰
- ä¿æŠ¤ä»£ç†ï¼ˆæƒé™æ§åˆ¶ï¼‰
- Spring AOP

#### é™æ€ä»£ç†
```java
/**
 * é™æ€ä»£ç†
 * @author erik.zhou
 */
interface UserService {
    void save(User user);
}

class UserServiceImpl implements UserService {
    @Override
    public void save(User user) {
        System.out.println("ä¿å­˜ç”¨æˆ·ï¼š" + user.getName());
    }
}

class UserServiceProxy implements UserService {
    private final UserService target;
    
    public UserServiceProxy(UserService target) {
        this.target = target;
    }
    
    @Override
    public void save(User user) {
        System.out.println("ä»£ç†ï¼šå¼€å§‹äº‹åŠ¡");
        target.save(user);
        System.out.println("ä»£ç†ï¼šæäº¤äº‹åŠ¡");
    }
}
```

#### åŠ¨æ€ä»£ç†ï¼ˆJDKï¼‰ğŸ”¥
```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

/**
 * JDKåŠ¨æ€ä»£ç†
 * @author erik.zhou
 */
public class JdkProxyDemo {
    public static void main(String[] args) {
        UserService target = new UserServiceImpl();
        
        UserService proxy = (UserService) Proxy.newProxyInstance(
            target.getClass().getClassLoader(),
            target.getClass().getInterfaces(),
            new InvocationHandler() {
                @Override
                public Object invoke(Object proxy, Method method, Object[] args) 
                        throws Throwable {
                    System.out.println("ä»£ç†ï¼šæ–¹æ³•æ‰§è¡Œå‰");
                    Object result = method.invoke(target, args);
                    System.out.println("ä»£ç†ï¼šæ–¹æ³•æ‰§è¡Œå");
                    return result;
                }
            }
        );
        
        proxy.save(new User("å¼ ä¸‰"));
    }
}
```

#### CGLIBåŠ¨æ€ä»£ç†
```java
import net.sf.cglib.proxy.Enhancer;
import net.sf.cglib.proxy.MethodInterceptor;
import net.sf.cglib.proxy.MethodProxy;

/**
 * CGLIBåŠ¨æ€ä»£ç†
 * @author erik.zhou
 */
public class CglibProxyDemo {
    public static void main(String[] args) {
        Enhancer enhancer = new Enhancer();
        enhancer.setSuperclass(UserServiceImpl.class);
        enhancer.setCallback(new MethodInterceptor() {
            @Override
            public Object intercept(Object obj, Method method, Object[] args, 
                    MethodProxy proxy) throws Throwable {
                System.out.println("ä»£ç†ï¼šæ–¹æ³•æ‰§è¡Œå‰");
                Object result = proxy.invokeSuper(obj, args);
                System.out.println("ä»£ç†ï¼šæ–¹æ³•æ‰§è¡Œå");
                return result;
            }
        });
        
        UserServiceImpl proxy = (UserServiceImpl) enhancer.create();
        proxy.save(new User("å¼ ä¸‰"));
    }
}
```

### 7. è£…é¥°å™¨æ¨¡å¼ï¼ˆDecoratorï¼‰ğŸ”¥

**å®šä¹‰**: åŠ¨æ€åœ°ç»™å¯¹è±¡æ·»åŠ é¢å¤–çš„èŒè´£

**åº”ç”¨åœºæ™¯**:
- Java I/Oæµï¼ˆBufferedReaderã€InputStreamReaderï¼‰
- Springä¸­çš„BeanWrapper

```java
/**
 * è£…é¥°å™¨æ¨¡å¼
 * @author erik.zhou
 */
// ç»„ä»¶æ¥å£
interface Coffee {
    double cost();
    String description();
}

// å…·ä½“ç»„ä»¶
class SimpleCoffee implements Coffee {
    @Override
    public double cost() {
        return 10.0;
    }
    
    @Override
    public String description() {
        return "ç®€å•å’–å•¡";
    }
}

// è£…é¥°å™¨åŸºç±»
abstract class CoffeeDecorator implements Coffee {
    protected final Coffee coffee;
    
    public CoffeeDecorator(Coffee coffee) {
        this.coffee = coffee;
    }
}

// å…·ä½“è£…é¥°å™¨
class MilkDecorator extends CoffeeDecorator {
    public MilkDecorator(Coffee coffee) {
        super(coffee);
    }
    
    @Override
    public double cost() {
        return coffee.cost() + 2.0;
    }
    
    @Override
    public String description() {
        return coffee.description() + " + ç‰›å¥¶";
    }
}

class SugarDecorator extends CoffeeDecorator {
    public SugarDecorator(Coffee coffee) {
        super(coffee);
    }
    
    @Override
    public double cost() {
        return coffee.cost() + 1.0;
    }
    
    @Override
    public String description() {
        return coffee.description() + " + ç³–";
    }
}

// ä½¿ç”¨
public class DecoratorDemo {
    public static void main(String[] args) {
        Coffee coffee = new SimpleCoffee();
        coffee = new MilkDecorator(coffee);
        coffee = new SugarDecorator(coffee);
        
        System.out.println(coffee.description() + "ï¼Œä»·æ ¼ï¼š" + coffee.cost());
    }
}
```

### 8. é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰

**å®šä¹‰**: å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦ä¸€ä¸ªæ¥å£

**åº”ç”¨åœºæ™¯**:
- ç³»ç»Ÿé›†æˆ
- ç¬¬ä¸‰æ–¹åº“é€‚é…
- Spring MVCçš„HandlerAdapter

```java
/**
 * é€‚é…å™¨æ¨¡å¼
 * @author erik.zhou
 */
// ç›®æ ‡æ¥å£
interface Target {
    void request();
}

// è¢«é€‚é…è€…
class Adaptee {
    public void specificRequest() {
        System.out.println("ç‰¹æ®Šè¯·æ±‚");
    }
}

// é€‚é…å™¨
class Adapter implements Target {
    private final Adaptee adaptee;
    
    public Adapter(Adaptee adaptee) {
        this.adaptee = adaptee;
    }
    
    @Override
    public void request() {
        adaptee.specificRequest();
    }
}

// ä½¿ç”¨
public class AdapterDemo {
    public static void main(String[] args) {
        Adaptee adaptee = new Adaptee();
        Target target = new Adapter(adaptee);
        target.request();
    }
}
```

### 9. æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰

**å®šä¹‰**: å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»

**åº”ç”¨åœºæ™¯**:
- JDBCé©±åŠ¨
- æ¶ˆæ¯å‘é€ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ï¼‰

```java
/**
 * æ¡¥æ¥æ¨¡å¼
 * @author erik.zhou
 */
// å®ç°æ¥å£
interface MessageSender {
    void send(String message);
}

// å…·ä½“å®ç°
class EmailSender implements MessageSender {
    @Override
    public void send(String message) {
        System.out.println("é‚®ä»¶å‘é€ï¼š" + message);
    }
}

class SmsSender implements MessageSender {
    @Override
    public void send(String message) {
        System.out.println("çŸ­ä¿¡å‘é€ï¼š" + message);
    }
}

// æŠ½è±¡ç±»
abstract class Message {
    protected MessageSender sender;
    
    public Message(MessageSender sender) {
        this.sender = sender;
    }
    
    public abstract void send(String content);
}

// æ‰©å±•æŠ½è±¡ç±»
class UrgentMessage extends Message {
    public UrgentMessage(MessageSender sender) {
        super(sender);
    }
    
    @Override
    public void send(String content) {
        sender.send("ã€ç´§æ€¥ã€‘" + content);
    }
}

class NormalMessage extends Message {
    public NormalMessage(MessageSender sender) {
        super(sender);
    }
    
    @Override
    public void send(String content) {
        sender.send(content);
    }
}
```

### 10. ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰

**å®šä¹‰**: å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤º"éƒ¨åˆ†-æ•´ä½“"çš„å±‚æ¬¡ç»“æ„

**åº”ç”¨åœºæ™¯**:
- æ–‡ä»¶ç³»ç»Ÿ
- ç»„ç»‡æ¶æ„
- UIç»„ä»¶æ ‘

```java
import java.util.ArrayList;
import java.util.List;

/**
 * ç»„åˆæ¨¡å¼
 * @author erik.zhou
 */
// ç»„ä»¶æ¥å£
interface Component {
    void operation();
}

// å¶å­èŠ‚ç‚¹
class Leaf implements Component {
    private final String name;
    
    public Leaf(String name) {
        this.name = name;
    }
    
    @Override
    public void operation() {
        System.out.println("å¶å­èŠ‚ç‚¹ï¼š" + name);
    }
}

// ç»„åˆèŠ‚ç‚¹
class Composite implements Component {
    private final String name;
    private final List<Component> children = new ArrayList<>();
    
    public Composite(String name) {
        this.name = name;
    }
    
    public void add(Component component) {
        children.add(component);
    }
    
    public void remove(Component component) {
        children.remove(component);
    }
    
    @Override
    public void operation() {
        System.out.println("ç»„åˆèŠ‚ç‚¹ï¼š" + name);
        for (Component child : children) {
            child.operation();
        }
    }
}
```

### 11. å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰

**å®šä¹‰**: ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£

**åº”ç”¨åœºæ™¯**:
- ç®€åŒ–å¤æ‚ç³»ç»Ÿ
- åˆ†å±‚æ¶æ„ä¸­çš„æœåŠ¡å±‚

```java
/**
 * å¤–è§‚æ¨¡å¼
 * @author erik.zhou
 */
// å­ç³»ç»Ÿ
class CPU {
    public void start() {
        System.out.println("CPUå¯åŠ¨");
    }
}

class Memory {
    public void load() {
        System.out.println("å†…å­˜åŠ è½½");
    }
}

class HardDrive {
    public void read() {
        System.out.println("ç¡¬ç›˜è¯»å–");
    }
}

// å¤–è§‚ç±»
class ComputerFacade {
    private final CPU cpu;
    private final Memory memory;
    private final HardDrive hardDrive;
    
    public ComputerFacade() {
        this.cpu = new CPU();
        this.memory = new Memory();
        this.hardDrive = new HardDrive();
    }
    
    public void start() {
        cpu.start();
        memory.load();
        hardDrive.read();
        System.out.println("è®¡ç®—æœºå¯åŠ¨å®Œæˆ");
    }
}
```

### 12. äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰

**å®šä¹‰**: è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨

**åº”ç”¨åœºæ™¯**:
- å­—ç¬¦ä¸²å¸¸é‡æ± 
- æ•°æ®åº“è¿æ¥æ± 
- Integerç¼“å­˜ï¼ˆ-128åˆ°127ï¼‰

```java
import java.util.HashMap;
import java.util.Map;

/**
 * äº«å…ƒæ¨¡å¼
 * @author erik.zhou
 */
// äº«å…ƒæ¥å£
interface Flyweight {
    void operation(String extrinsicState);
}

// å…·ä½“äº«å…ƒ
class ConcreteFlyweight implements Flyweight {
    private final String intrinsicState;
    
    public ConcreteFlyweight(String intrinsicState) {
        this.intrinsicState = intrinsicState;
    }
    
    @Override
    public void operation(String extrinsicState) {
        System.out.println("å†…éƒ¨çŠ¶æ€ï¼š" + intrinsicState + 
                         "ï¼Œå¤–éƒ¨çŠ¶æ€ï¼š" + extrinsicState);
    }
}

// äº«å…ƒå·¥å‚
class FlyweightFactory {
    private final Map<String, Flyweight> pool = new HashMap<>();
    
    public Flyweight getFlyweight(String key) {
        if (!pool.containsKey(key)) {
            pool.put(key, new ConcreteFlyweight(key));
        }
        return pool.get(key);
    }
}
```

## ğŸ”¥ è¡Œä¸ºå‹æ¨¡å¼

è¡Œä¸ºå‹æ¨¡å¼å…³æ³¨å¯¹è±¡ä¹‹é—´çš„é€šä¿¡å’ŒèŒè´£åˆ†é…ã€‚


### 13. è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰ğŸ”¥

**å®šä¹‰**: å®šä¹‰å¯¹è±¡é—´çš„ä¸€å¯¹å¤šä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–è€…éƒ½ä¼šæ”¶åˆ°é€šçŸ¥

**åº”ç”¨åœºæ™¯**:
- äº‹ä»¶ç›‘å¬æœºåˆ¶
- MVCæ¶æ„
- æ¶ˆæ¯è®¢é˜…

```java
import java.util.ArrayList;
import java.util.List;

/**
 * è§‚å¯Ÿè€…æ¨¡å¼
 * @author erik.zhou
 */
// è§‚å¯Ÿè€…æ¥å£
interface Observer {
    void update(String message);
}

// å…·ä½“è§‚å¯Ÿè€…
class ConcreteObserver implements Observer {
    private final String name;
    
    public ConcreteObserver(String name) {
        this.name = name;
    }
    
    @Override
    public void update(String message) {
        System.out.println(name + "æ”¶åˆ°æ¶ˆæ¯ï¼š" + message);
    }
}

// ä¸»é¢˜æ¥å£
interface Subject {
    void attach(Observer observer);
    void detach(Observer observer);
    void notifyObservers();
}

// å…·ä½“ä¸»é¢˜
class ConcreteSubject implements Subject {
    private final List<Observer> observers = new ArrayList<>();
    private String state;
    
    @Override
    public void attach(Observer observer) {
        observers.add(observer);
    }
    
    @Override
    public void detach(Observer observer) {
        observers.remove(observer);
    }
    
    @Override
    public void notifyObservers() {
        for (Observer observer : observers) {
            observer.update(state);
        }
    }
    
    public void setState(String state) {
        this.state = state;
        notifyObservers();
    }
}

// ä½¿ç”¨
public class ObserverDemo {
    public static void main(String[] args) {
        ConcreteSubject subject = new ConcreteSubject();
        
        Observer observer1 = new ConcreteObserver("è§‚å¯Ÿè€…1");
        Observer observer2 = new ConcreteObserver("è§‚å¯Ÿè€…2");
        
        subject.attach(observer1);
        subject.attach(observer2);
        
        subject.setState("çŠ¶æ€æ”¹å˜äº†");
    }
}
```

### 14. ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ğŸ”¥

**å®šä¹‰**: å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬å°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢

**åº”ç”¨åœºæ™¯**:
- æ”¯ä»˜æ–¹å¼é€‰æ‹©
- æ’åºç®—æ³•é€‰æ‹©
- ä¼˜æƒ åˆ¸è®¡ç®—

```java
/**
 * ç­–ç•¥æ¨¡å¼
 * @author erik.zhou
 */
// ç­–ç•¥æ¥å£
interface PaymentStrategy {
    void pay(double amount);
}

// å…·ä½“ç­–ç•¥
class AlipayStrategy implements PaymentStrategy {
    @Override
    public void pay(double amount) {
        System.out.println("ä½¿ç”¨æ”¯ä»˜å®æ”¯ä»˜ï¼š" + amount);
    }
}

class WechatStrategy implements PaymentStrategy {
    @Override
    public void pay(double amount) {
        System.out.println("ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜ï¼š" + amount);
    }
}

class CreditCardStrategy implements PaymentStrategy {
    @Override
    public void pay(double amount) {
        System.out.println("ä½¿ç”¨ä¿¡ç”¨å¡æ”¯ä»˜ï¼š" + amount);
    }
}

// ä¸Šä¸‹æ–‡
class PaymentContext {
    private PaymentStrategy strategy;
    
    public void setStrategy(PaymentStrategy strategy) {
        this.strategy = strategy;
    }
    
    public void pay(double amount) {
        strategy.pay(amount);
    }
}

// ä½¿ç”¨
public class StrategyDemo {
    public static void main(String[] args) {
        PaymentContext context = new PaymentContext();
        
        context.setStrategy(new AlipayStrategy());
        context.pay(100.0);
        
        context.setStrategy(new WechatStrategy());
        context.pay(200.0);
    }
}
```

### 15. æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Methodï¼‰ğŸ”¥

**å®šä¹‰**: å®šä¹‰ç®—æ³•éª¨æ¶ï¼Œå°†æŸäº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»å®ç°

**åº”ç”¨åœºæ™¯**:
- Springçš„JdbcTemplate
- Servletçš„serviceæ–¹æ³•
- æ•°æ®å¤„ç†æµç¨‹

```java
/**
 * æ¨¡æ¿æ–¹æ³•æ¨¡å¼
 * @author erik.zhou
 */
abstract class AbstractClass {
    // æ¨¡æ¿æ–¹æ³•
    public final void templateMethod() {
        step1();
        step2();
        if (hook()) {
            step3();
        }
        step4();
    }
    
    // å…·ä½“æ–¹æ³•
    private void step1() {
        System.out.println("æ­¥éª¤1ï¼šé€šç”¨æ“ä½œ");
    }
    
    // æŠ½è±¡æ–¹æ³•ï¼ˆå­ç±»å¿…é¡»å®ç°ï¼‰
    protected abstract void step2();
    
    protected abstract void step3();
    
    // å…·ä½“æ–¹æ³•
    private void step4() {
        System.out.println("æ­¥éª¤4ï¼šé€šç”¨æ“ä½œ");
    }
    
    // é’©å­æ–¹æ³•ï¼ˆå­ç±»å¯é€‰æ‹©æ€§è¦†ç›–ï¼‰
    protected boolean hook() {
        return true;
    }
}

class ConcreteClassA extends AbstractClass {
    @Override
    protected void step2() {
        System.out.println("æ­¥éª¤2ï¼šAçš„å®ç°");
    }
    
    @Override
    protected void step3() {
        System.out.println("æ­¥éª¤3ï¼šAçš„å®ç°");
    }
}

class ConcreteClassB extends AbstractClass {
    @Override
    protected void step2() {
        System.out.println("æ­¥éª¤2ï¼šBçš„å®ç°");
    }
    
    @Override
    protected void step3() {
        System.out.println("æ­¥éª¤3ï¼šBçš„å®ç°");
    }
    
    @Override
    protected boolean hook() {
        return false; // è·³è¿‡step3
    }
}
```

### 16. è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibilityï¼‰ğŸ”¥

**å®šä¹‰**: å°†è¯·æ±‚æ²¿ç€å¤„ç†è€…é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒ

**åº”ç”¨åœºæ™¯**:
- å®¡æ‰¹æµç¨‹
- è¿‡æ»¤å™¨é“¾ï¼ˆServlet Filterï¼‰
- å¼‚å¸¸å¤„ç†

```java
/**
 * è´£ä»»é“¾æ¨¡å¼
 * @author erik.zhou
 */
// å¤„ç†è€…æŠ½è±¡ç±»
abstract class Handler {
    protected Handler nextHandler;
    
    public void setNextHandler(Handler nextHandler) {
        this.nextHandler = nextHandler;
    }
    
    public abstract void handleRequest(int level);
}

// å…·ä½“å¤„ç†è€…
class ConcreteHandler1 extends Handler {
    @Override
    public void handleRequest(int level) {
        if (level <= 1) {
            System.out.println("å¤„ç†è€…1å¤„ç†è¯·æ±‚");
        } else if (nextHandler != null) {
            nextHandler.handleRequest(level);
        }
    }
}

class ConcreteHandler2 extends Handler {
    @Override
    public void handleRequest(int level) {
        if (level <= 2) {
            System.out.println("å¤„ç†è€…2å¤„ç†è¯·æ±‚");
        } else if (nextHandler != null) {
            nextHandler.handleRequest(level);
        }
    }
}

class ConcreteHandler3 extends Handler {
    @Override
    public void handleRequest(int level) {
        if (level <= 3) {
            System.out.println("å¤„ç†è€…3å¤„ç†è¯·æ±‚");
        } else {
            System.out.println("æ— æ³•å¤„ç†è¯·æ±‚");
        }
    }
}

// ä½¿ç”¨
public class ChainDemo {
    public static void main(String[] args) {
        Handler handler1 = new ConcreteHandler1();
        Handler handler2 = new ConcreteHandler2();
        Handler handler3 = new ConcreteHandler3();
        
        handler1.setNextHandler(handler2);
        handler2.setNextHandler(handler3);
        
        handler1.handleRequest(2);
    }
}
```

### 17. å‘½ä»¤æ¨¡å¼ï¼ˆCommandï¼‰

**å®šä¹‰**: å°†è¯·æ±‚å°è£…æˆå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–

**åº”ç”¨åœºæ™¯**:
- æ’¤é”€/é‡åšåŠŸèƒ½
- äº‹åŠ¡ç®¡ç†
- ä»»åŠ¡é˜Ÿåˆ—

```java
import java.util.ArrayList;
import java.util.List;

/**
 * å‘½ä»¤æ¨¡å¼
 * @author erik.zhou
 */
// å‘½ä»¤æ¥å£
interface Command {
    void execute();
    void undo();
}

// æ¥æ”¶è€…
class Light {
    public void on() {
        System.out.println("ç¯æ‰“å¼€");
    }
    
    public void off() {
        System.out.println("ç¯å…³é—­");
    }
}

// å…·ä½“å‘½ä»¤
class LightOnCommand implements Command {
    private final Light light;
    
    public LightOnCommand(Light light) {
        this.light = light;
    }
    
    @Override
    public void execute() {
        light.on();
    }
    
    @Override
    public void undo() {
        light.off();
    }
}

class LightOffCommand implements Command {
    private final Light light;
    
    public LightOffCommand(Light light) {
        this.light = light;
    }
    
    @Override
    public void execute() {
        light.off();
    }
    
    @Override
    public void undo() {
        light.on();
    }
}

// è°ƒç”¨è€…
class RemoteControl {
    private final List<Command> history = new ArrayList<>();
    
    public void executeCommand(Command command) {
        command.execute();
        history.add(command);
    }
    
    public void undo() {
        if (!history.isEmpty()) {
            Command command = history.remove(history.size() - 1);
            command.undo();
        }
    }
}
```

### 18. è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰

**å®šä¹‰**: æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„å…ƒç´ ï¼Œè€Œä¸æš´éœ²å…¶å†…éƒ¨è¡¨ç¤º

**åº”ç”¨åœºæ™¯**:
- Javaé›†åˆæ¡†æ¶
- éå†å¤æ‚æ•°æ®ç»“æ„

```java
import java.util.ArrayList;
import java.util.List;

/**
 * è¿­ä»£å™¨æ¨¡å¼
 * @author erik.zhou
 */
// è¿­ä»£å™¨æ¥å£
interface Iterator<T> {
    boolean hasNext();
    T next();
}

// èšåˆæ¥å£
interface Aggregate<T> {
    Iterator<T> createIterator();
}

// å…·ä½“è¿­ä»£å™¨
class ConcreteIterator<T> implements Iterator<T> {
    private final List<T> list;
    private int position = 0;
    
    public ConcreteIterator(List<T> list) {
        this.list = list;
    }
    
    @Override
    public boolean hasNext() {
        return position < list.size();
    }
    
    @Override
    public T next() {
        return list.get(position++);
    }
}

// å…·ä½“èšåˆ
class ConcreteAggregate<T> implements Aggregate<T> {
    private final List<T> list = new ArrayList<>();
    
    public void add(T item) {
        list.add(item);
    }
    
    @Override
    public Iterator<T> createIterator() {
        return new ConcreteIterator<>(list);
    }
}
```

### 19. ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediatorï¼‰

**å®šä¹‰**: ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡äº¤äº’

**åº”ç”¨åœºæ™¯**:
- èŠå¤©å®¤
- MVCä¸­çš„Controller
- æœºåœºè°ƒåº¦ç³»ç»Ÿ

```java
import java.util.ArrayList;
import java.util.List;

/**
 * ä¸­ä»‹è€…æ¨¡å¼
 * @author erik.zhou
 */
// ä¸­ä»‹è€…æ¥å£
interface Mediator {
    void sendMessage(String message, Colleague colleague);
}

// åŒäº‹ç±»
abstract class Colleague {
    protected Mediator mediator;
    
    public Colleague(Mediator mediator) {
        this.mediator = mediator;
    }
    
    public abstract void receive(String message);
    public abstract void send(String message);
}

// å…·ä½“åŒäº‹ç±»
class ConcreteColleague extends Colleague {
    private final String name;
    
    public ConcreteColleague(Mediator mediator, String name) {
        super(mediator);
        this.name = name;
    }
    
    @Override
    public void receive(String message) {
        System.out.println(name + "æ”¶åˆ°æ¶ˆæ¯ï¼š" + message);
    }
    
    @Override
    public void send(String message) {
        System.out.println(name + "å‘é€æ¶ˆæ¯ï¼š" + message);
        mediator.sendMessage(message, this);
    }
}

// å…·ä½“ä¸­ä»‹è€…
class ConcreteMediator implements Mediator {
    private final List<Colleague> colleagues = new ArrayList<>();
    
    public void addColleague(Colleague colleague) {
        colleagues.add(colleague);
    }
    
    @Override
    public void sendMessage(String message, Colleague colleague) {
        for (Colleague c : colleagues) {
            if (c != colleague) {
                c.receive(message);
            }
        }
    }
}
```

### 20. å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰

**å®šä¹‰**: åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€å¹¶ä¿å­˜

**åº”ç”¨åœºæ™¯**:
- æ’¤é”€åŠŸèƒ½
- äº‹åŠ¡å›æ»š
- æ¸¸æˆå­˜æ¡£

```java
import java.util.Stack;

/**
 * å¤‡å¿˜å½•æ¨¡å¼
 * @author erik.zhou
 */
// å¤‡å¿˜å½•
class Memento {
    private final String state;
    
    public Memento(String state) {
        this.state = state;
    }
    
    public String getState() {
        return state;
    }
}

// å‘èµ·äºº
class Originator {
    private String state;
    
    public void setState(String state) {
        this.state = state;
    }
    
    public String getState() {
        return state;
    }
    
    public Memento saveToMemento() {
        return new Memento(state);
    }
    
    public void restoreFromMemento(Memento memento) {
        state = memento.getState();
    }
}

// ç®¡ç†è€…
class Caretaker {
    private final Stack<Memento> mementos = new Stack<>();
    
    public void save(Memento memento) {
        mementos.push(memento);
    }
    
    public Memento undo() {
        if (!mementos.isEmpty()) {
            return mementos.pop();
        }
        return null;
    }
}
```

### 21. çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰

**å®šä¹‰**: å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º

**åº”ç”¨åœºæ™¯**:
- è®¢å•çŠ¶æ€æµè½¬
- TCPè¿æ¥çŠ¶æ€
- å·¥ä½œæµå¼•æ“

```java
/**
 * çŠ¶æ€æ¨¡å¼
 * @author erik.zhou
 */
// çŠ¶æ€æ¥å£
interface State {
    void handle(Context context);
}

// å…·ä½“çŠ¶æ€
class ConcreteStateA implements State {
    @Override
    public void handle(Context context) {
        System.out.println("çŠ¶æ€Aå¤„ç†");
        context.setState(new ConcreteStateB());
    }
}

class ConcreteStateB implements State {
    @Override
    public void handle(Context context) {
        System.out.println("çŠ¶æ€Bå¤„ç†");
        context.setState(new ConcreteStateA());
    }
}

// ä¸Šä¸‹æ–‡
class Context {
    private State state;
    
    public Context(State state) {
        this.state = state;
    }
    
    public void setState(State state) {
        this.state = state;
    }
    
    public void request() {
        state.handle(this);
    }
}
```

### 22. è®¿é—®è€…æ¨¡å¼ï¼ˆVisitorï¼‰ï¼ˆâš ï¸ éš¾ç‚¹ï¼‰

**å®šä¹‰**: è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œ

**åº”ç”¨åœºæ™¯**:
- ç¼–è¯‘å™¨çš„è¯­æ³•æ ‘éå†
- å¯¹è±¡ç»“æ„ç¨³å®šä½†æ“ä½œå¤šå˜

```java
/**
 * è®¿é—®è€…æ¨¡å¼
 * @author erik.zhou
 */
// è®¿é—®è€…æ¥å£
interface Visitor {
    void visit(ConcreteElementA element);
    void visit(ConcreteElementB element);
}

// å…ƒç´ æ¥å£
interface Element {
    void accept(Visitor visitor);
}

// å…·ä½“å…ƒç´ 
class ConcreteElementA implements Element {
    @Override
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
    
    public void operationA() {
        System.out.println("å…ƒç´ Açš„æ“ä½œ");
    }
}

class ConcreteElementB implements Element {
    @Override
    public void accept(Visitor visitor) {
        visitor.visit(this);
    }
    
    public void operationB() {
        System.out.println("å…ƒç´ Bçš„æ“ä½œ");
    }
}

// å…·ä½“è®¿é—®è€…
class ConcreteVisitor implements Visitor {
    @Override
    public void visit(ConcreteElementA element) {
        System.out.println("è®¿é—®å…ƒç´ A");
        element.operationA();
    }
    
    @Override
    public void visit(ConcreteElementB element) {
        System.out.println("è®¿é—®å…ƒç´ B");
        element.operationB();
    }
}
```

### 23. è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreterï¼‰

**å®šä¹‰**: ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨

**åº”ç”¨åœºæ™¯**:
- SQLè§£æ
- æ­£åˆ™è¡¨è¾¾å¼
- ç¼–è¯‘å™¨

```java
/**
 * è§£é‡Šå™¨æ¨¡å¼
 * @author erik.zhou
 */
// æŠ½è±¡è¡¨è¾¾å¼
interface Expression {
    int interpret();
}

// ç»ˆç»“ç¬¦è¡¨è¾¾å¼
class NumberExpression implements Expression {
    private final int number;
    
    public NumberExpression(int number) {
        this.number = number;
    }
    
    @Override
    public int interpret() {
        return number;
    }
}

// éç»ˆç»“ç¬¦è¡¨è¾¾å¼
class AddExpression implements Expression {
    private final Expression left;
    private final Expression right;
    
    public AddExpression(Expression left, Expression right) {
        this.left = left;
        this.right = right;
    }
    
    @Override
    public int interpret() {
        return left.interpret() + right.interpret();
    }
}

class SubtractExpression implements Expression {
    private final Expression left;
    private final Expression right;
    
    public SubtractExpression(Expression left, Expression right) {
        this.left = left;
        this.right = right;
    }
    
    @Override
    public int interpret() {
        return left.interpret() - right.interpret();
    }
}

// ä½¿ç”¨
public class InterpreterDemo {
    public static void main(String[] args) {
        // è®¡ç®— (5 + 3) - 2
        Expression expression = new SubtractExpression(
            new AddExpression(
                new NumberExpression(5),
                new NumberExpression(3)
            ),
            new NumberExpression(2)
        );
        
        System.out.println("ç»“æœï¼š" + expression.interpret());
    }
}
```

## ğŸ’» å®æˆ˜åº”ç”¨

### Springæ¡†æ¶ä¸­çš„è®¾è®¡æ¨¡å¼

1. **å•ä¾‹æ¨¡å¼**: Spring Beané»˜è®¤æ˜¯å•ä¾‹
2. **å·¥å‚æ¨¡å¼**: BeanFactoryã€ApplicationContext
3. **ä»£ç†æ¨¡å¼**: AOPå®ç°
4. **æ¨¡æ¿æ–¹æ³•**: JdbcTemplateã€RestTemplate
5. **è§‚å¯Ÿè€…æ¨¡å¼**: ApplicationEventã€ApplicationListener
6. **ç­–ç•¥æ¨¡å¼**: Resourceæ¥å£çš„ä¸åŒå®ç°
7. **é€‚é…å™¨æ¨¡å¼**: HandlerAdapter
8. **è£…é¥°å™¨æ¨¡å¼**: BeanWrapper

### MyBatisä¸­çš„è®¾è®¡æ¨¡å¼

1. **å»ºé€ è€…æ¨¡å¼**: SqlSessionFactoryBuilder
2. **å·¥å‚æ¨¡å¼**: SqlSessionFactory
3. **ä»£ç†æ¨¡å¼**: MapperProxy
4. **æ¨¡æ¿æ–¹æ³•**: BaseExecutor
5. **è£…é¥°å™¨æ¨¡å¼**: Cacheçš„å®ç°

## âœ¨ æœ€ä½³å®è·µ

### 1. è®¾è®¡æ¨¡å¼é€‰æ‹©æŒ‡å—

**åˆ›å»ºå¯¹è±¡æ—¶**:
- éœ€è¦å•ä¾‹ â†’ å•ä¾‹æ¨¡å¼
- å¤æ‚å¯¹è±¡æ„å»º â†’ å»ºé€ è€…æ¨¡å¼
- ä¸ç¡®å®šåˆ›å»ºå“ªä¸ªç±» â†’ å·¥å‚æ–¹æ³•æ¨¡å¼
- åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³å¯¹è±¡ â†’ æŠ½è±¡å·¥å‚æ¨¡å¼

**ç»„ç»‡ç±»ç»“æ„æ—¶**:
- éœ€è¦å¢å¼ºåŠŸèƒ½ â†’ è£…é¥°å™¨æ¨¡å¼
- æ¥å£ä¸å…¼å®¹ â†’ é€‚é…å™¨æ¨¡å¼
- æ§åˆ¶è®¿é—® â†’ ä»£ç†æ¨¡å¼
- ç®€åŒ–å¤æ‚ç³»ç»Ÿ â†’ å¤–è§‚æ¨¡å¼

**å¯¹è±¡è¡Œä¸ºæ—¶**:
- ç®—æ³•å¯æ›¿æ¢ â†’ ç­–ç•¥æ¨¡å¼
- ä¸€å¯¹å¤šä¾èµ– â†’ è§‚å¯Ÿè€…æ¨¡å¼
- è¯·æ±‚é“¾å¼å¤„ç† â†’ è´£ä»»é“¾æ¨¡å¼
- å®šä¹‰ç®—æ³•éª¨æ¶ â†’ æ¨¡æ¿æ–¹æ³•æ¨¡å¼

### 2. é¿å…è¿‡åº¦è®¾è®¡ âš ï¸

```java
// é”™è¯¯ï¼šè¿‡åº¦ä½¿ç”¨è®¾è®¡æ¨¡å¼
public class OverDesign {
    // ç®€å•çš„é…ç½®ç±»ä¸éœ€è¦å•ä¾‹
    public static class ConfigSingleton {
        private static volatile ConfigSingleton instance;
        // å¤æ‚çš„åŒé‡æ£€æŸ¥é”...
    }
    
    // ç®€å•çš„if-elseä¸éœ€è¦ç­–ç•¥æ¨¡å¼
    public interface SimpleStrategy {
        void execute();
    }
}

// æ­£ç¡®ï¼šä¿æŒç®€å•
public class SimpleDesign {
    // ç®€å•é…ç½®ç›´æ¥ä½¿ç”¨
    public static class Config {
        public static final String APP_NAME = "MyApp";
    }
    
    // ç®€å•é€»è¾‘ç›´æ¥if-else
    public void process(String type) {
        if ("A".equals(type)) {
            // å¤„ç†A
        } else {
            // å¤„ç†B
        }
    }
}
```

### 3. å¸¸è§é™·é˜±

âš ï¸ **é™·é˜±1ï¼šå•ä¾‹æ¨¡å¼çš„çº¿ç¨‹å®‰å…¨**
```java
// é”™è¯¯ï¼šæ‡’æ±‰å¼ä¸å®‰å…¨
public class Singleton {
    private static Singleton instance;
    
    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton(); // çº¿ç¨‹ä¸å®‰å…¨
        }
        return instance;
    }
}

// æ­£ç¡®ï¼šä½¿ç”¨é™æ€å†…éƒ¨ç±»
public class Singleton {
    private static class Holder {
        private static final Singleton INSTANCE = new Singleton();
    }
    
    public static Singleton getInstance() {
        return Holder.INSTANCE;
    }
}
```

âš ï¸ **é™·é˜±2ï¼šå·¥å‚æ¨¡å¼çš„æ‰©å±•æ€§**
```java
// é”™è¯¯ï¼šç®€å•å·¥å‚è¿åå¼€é—­åŸåˆ™
public class SimpleFactory {
    public static Product create(String type) {
        if ("A".equals(type)) {
            return new ProductA();
        } else if ("B".equals(type)) {
            return new ProductB();
        }
        return null;
    }
}

// æ­£ç¡®ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼
public interface Factory {
    Product create();
}

public class FactoryA implements Factory {
    @Override
    public Product create() {
        return new ProductA();
    }
}
```

## â“ å¸¸è§é—®é¢˜

### Q1: è®¾è®¡æ¨¡å¼å’Œè®¾è®¡åŸåˆ™çš„å…³ç³»ï¼Ÿ
A: è®¾è®¡åŸåˆ™æ˜¯æŒ‡å¯¼æ€æƒ³ï¼Œè®¾è®¡æ¨¡å¼æ˜¯å…·ä½“å®ç°ã€‚è®¾è®¡æ¨¡å¼éµå¾ªè®¾è®¡åŸåˆ™ï¼Œå¦‚å•ä¾‹æ¨¡å¼éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Œç­–ç•¥æ¨¡å¼éµå¾ªå¼€é—­åŸåˆ™ã€‚

### Q2: å¦‚ä½•é€‰æ‹©åˆé€‚çš„è®¾è®¡æ¨¡å¼ï¼Ÿ
A: 
1. ç†è§£é—®é¢˜æœ¬è´¨
2. åˆ†ææ˜¯åˆ›å»ºã€ç»“æ„è¿˜æ˜¯è¡Œä¸ºé—®é¢˜
3. è€ƒè™‘å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§
4. é¿å…è¿‡åº¦è®¾è®¡

### Q3: è®¾è®¡æ¨¡å¼ä¼šå½±å“æ€§èƒ½å—ï¼Ÿ
A: å¤§å¤šæ•°è®¾è®¡æ¨¡å¼å¯¹æ€§èƒ½å½±å“å¾ˆå°ï¼Œä½†æŸäº›æ¨¡å¼ï¼ˆå¦‚ä»£ç†æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ï¼‰ä¼šå¢åŠ æ–¹æ³•è°ƒç”¨å±‚æ¬¡ã€‚åº”åœ¨å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½ä¹‹é—´æƒè¡¡ã€‚

### Q4: Springä¸­ä¸ºä»€ä¹ˆå¤§é‡ä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼Ÿ
A: Springä½œä¸ºä¼ä¸šçº§æ¡†æ¶ï¼Œéœ€è¦é«˜åº¦çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚è®¾è®¡æ¨¡å¼å¸®åŠ©Springå®ç°äº†æ¾è€¦åˆã€æ˜“æ‰©å±•çš„æ¶æ„ã€‚

### Q5: å¦‚ä½•å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Ÿ
A:
1. ç†è§£è®¾è®¡åŸåˆ™
2. å­¦ä¹ æ¯ä¸ªæ¨¡å¼çš„å®šä¹‰å’Œåº”ç”¨åœºæ™¯
3. é˜…è¯»ä¼˜ç§€æ¡†æ¶æºç ï¼ˆSpringã€MyBatisï¼‰
4. åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨
5. é¿å…ä¸ºäº†ç”¨æ¨¡å¼è€Œç”¨æ¨¡å¼

## ğŸ”— ç›¸å…³èµ„æº

- [ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹](https://book.douban.com/subject/1052241/)ï¼ˆGoFï¼‰
- [ã€ŠHead Firstè®¾è®¡æ¨¡å¼ã€‹](https://book.douban.com/subject/2243615/)
- [ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹](https://book.douban.com/subject/2334288/)
- [Refactoring.Guruè®¾è®¡æ¨¡å¼](https://refactoring.guru/design-patterns)
- [èœé¸Ÿæ•™ç¨‹-è®¾è®¡æ¨¡å¼](https://www.runoob.com/design-pattern/design-pattern-tutorial.html)

## ğŸ“ å­¦ä¹ æ£€æŸ¥æ¸…å•

- [ ] ç†è§£å…­å¤§è®¾è®¡åŸåˆ™ï¼ˆSOLID + è¿ªç±³ç‰¹æ³•åˆ™ï¼‰
- [ ] æŒæ¡5ç§åˆ›å»ºå‹æ¨¡å¼
- [ ] æŒæ¡7ç§ç»“æ„å‹æ¨¡å¼
- [ ] æŒæ¡11ç§è¡Œä¸ºå‹æ¨¡å¼
- [ ] èƒ½å¤Ÿè¯†åˆ«Springæ¡†æ¶ä¸­çš„è®¾è®¡æ¨¡å¼
- [ ] èƒ½å¤Ÿåœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨åˆé€‚çš„è®¾è®¡æ¨¡å¼
- [ ] ç†è§£è®¾è®¡æ¨¡å¼ä¹‹é—´çš„å…³ç³»å’ŒåŒºåˆ«
- [ ] é¿å…è¿‡åº¦è®¾è®¡å’Œæ¨¡å¼æ»¥ç”¨
- [ ] èƒ½å¤Ÿé‡æ„ä»£ç ä»¥åº”ç”¨è®¾è®¡æ¨¡å¼
- [ ] ç†è§£è®¾è®¡æ¨¡å¼åœ¨å¼€æºæ¡†æ¶ä¸­çš„åº”ç”¨

---

**å­¦ä¹ å»ºè®®**ï¼š
1. å…ˆç†è§£è®¾è®¡åŸåˆ™ï¼Œå†å­¦ä¹ è®¾è®¡æ¨¡å¼
2. æ¯ä¸ªæ¨¡å¼éƒ½è¦åŠ¨æ‰‹å®ç°ä¸€é
3. é˜…è¯»Springã€MyBatisç­‰æ¡†æ¶æºç 
4. åœ¨å®é™…é¡¹ç›®ä¸­åº”ç”¨ï¼Œè€Œä¸æ˜¯ä¸ºäº†ç”¨è€Œç”¨
5. å…³æ³¨é˜¿é‡Œå·´å·´å¼€å‘è§„èŒƒä¸­çš„è®¾è®¡æ¨¡å¼å»ºè®®
6. å®šæœŸé‡æ„ä»£ç ï¼Œåº”ç”¨åˆé€‚çš„è®¾è®¡æ¨¡å¼
